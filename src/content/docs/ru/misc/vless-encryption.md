---
title: VLESS Encryption
description: –û–ø–∏—Å–∞–Ω–∏–µ Vless Encryption
---


# VLESS Encryption - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã](#—Ä–µ–∂–∏–º—ã-—Ä–∞–±–æ—Ç—ã)
4. [–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#—Ñ–æ—Ä–º–∞—Ç-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
5. [–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π](#–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–∫–ª—é—á–µ–π)
6. [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π](#–ø—Ä–∏–º–µ—Ä—ã-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π)
7. [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏](#—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-—Å-–¥—Ä—É–≥–∏–º–∏-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏)
8. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
9. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
10. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
11. [Best Practices](#best-practices)
12. [Troubleshooting](#troubleshooting)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

### –ß—Ç–æ —Ç–∞–∫–æ–µ VLESS Encryption?

VLESS Encryption - —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ, –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å Perfect Forward Secrecy (PFS) –¥–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ VLESS, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ –≤ Xray-core –≤ [PR #5067](https://github.com/XTLS/Xray-core/pull/5067).

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üîê **Post-Quantum –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è**: ML-KEM-768 + X25519
- üöÄ **0-RTT**: –ü–µ—Ä–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ 1-RTT, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ 0-RTT —á–µ—Ä–µ–∑ ticket
- üõ°Ô∏è **Perfect Forward Secrecy**: –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫
- üé≠ **–¢—Ä–∏ —Ä–µ–∂–∏–º–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞**: native / xorpub / random
- ‚ö° **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XTLS**: ReadV/Splice –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîí **–ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞**: –£—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ—à–ª—ã–π/–±—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫

### –î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

> **‚ö†Ô∏è –í–ê–ñ–ù–û**: VLESS Encryption **–ù–ï** –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä—è–º–æ–≥–æ –æ–±—Ö–æ–¥–∞ GFW!

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- üåê **CDN**: –ó–∞—â–∏—Ç–∞ UUID –∏ SNI –ø—Ä–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ CDN
- üîÑ **–¢—Ä–∞–Ω–∑–∏—Ç/Relay**: –¶–µ–ø–æ—á–∫–∏ –ø—Ä–æ–∫—Å–∏ –±–µ–∑ TLS (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–µ—Ç HTTP/TLS –Ω–∞ —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö)
- üáÆüá∑ **Non-TLS**: –°—Ç—Ä–∞–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ TLS (–ò—Ä–∞–Ω)
- üè¢ **–û–±—Ö–æ–¥ –∞—É–¥–∏—Ç–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞**: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ VPS —á–µ—Ä–µ–∑ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –ª–∏–Ω–∏–∏

**–î–ª—è –ø—Ä—è–º–æ–≥–æ –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
- [REALITY](https://github.com/XTLS/Xray-core/pull/4915)
- [XHTTP](https://github.com/XTLS/Xray-core/discussions/4113)
- [Vision](https://github.com/XTLS/Xray-core/discussions/1295)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ SS/VMess

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | VLESS Encryption | SS 2022/AEAD | VMess AEAD |
|----------------|------------------|--------------|------------|
| –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ —Ç—Ä–∞—Ñ–∏–∫–∞ | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (native/xorpub/random) | Random | Random |
| –ö–ª–∏–µ–Ω—Ç config –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚úÖ | ‚ùå | ‚ùå |
| Perfect Forward Secrecy | ‚úÖ | ‚ùå | ‚ùå |
| –ö–≤–∞–Ω—Ç–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å | ‚úÖ | ‚ùå | ‚ùå |
| RTT overhead | 0-RTT (–ø–æ—Å–ª–µ 1-RTT) | 0-RTT | 0-RTT |
| –ó–∞—â–∏—Ç–∞ –æ—Ç replay | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ |
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | O(1) –ø–æ ticket | O(n) –ø–µ—Ä–µ–±–æ—Ä | O(n) –ø–µ—Ä–µ–±–æ—Ä |
| Extra AEAD length | ‚ùå | ‚úÖ +13 –±–∞–π—Ç | ‚ùå |
| XTLS —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | ‚úÖ | ‚ùå | ‚ùå |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | **10% –±—ã—Å—Ç—Ä–µ–µ** | –ë–∞–∑–æ–≤–∞—è | –ë–∞–∑–æ–≤–∞—è |

---

## –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ì–∏–±—Ä–∏–¥–Ω–æ–µ Post-Quantum —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

VLESS Encryption –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **MLKEM768X25519** - –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ö–µ–º—É –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MLKEM768X25519 = ML-KEM-768 ‚äï X25519                  ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  ‚Ä¢ ML-KEM-768: –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–π KEM (NIST)         ‚îÇ
‚îÇ  ‚Ä¢ X25519: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ECDH (–±—ã—Å—Ç—Ä—ã–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π)   ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  –ó–∞—â–∏—Ç–∞: –î–∞–∂–µ –µ—Å–ª–∏ –æ–¥–∏–Ω –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω,    ‚îÇ
‚îÇ          –≤—Ç–æ—Ä–æ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ—á–µ–º—É –≥–∏–±—Ä–∏–¥?**
- ML-KEM-768 –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
- X25519 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ–≥–æ–¥–Ω—è
- –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ª—é–±–æ–≥–æ –∏–∑ –Ω–∏—Ö –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫

### Perfect Forward Secrecy (PFS)

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**
```
–í—Ä–µ–º—è: T0 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ T1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ T2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ T3
        ‚îÇ           ‚îÇ           ‚îÇ           ‚îÇ
–ö–ª—é—á–∏:  K0 ‚îÄ‚îÄ‚îÄ‚îÄX    K1 ‚îÄ‚îÄ‚îÄ‚îÄX    K2 ‚îÄ‚îÄ‚îÄ‚îÄX    K3
        ‚îÇ           ‚îÇ           ‚îÇ           ‚îÇ
–°–≤—è–∑—å:  –ù–µ—Ç –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª—é—á–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Å—Å–∏–π

–ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è K3 –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ T0, T1, T2
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ VLESS Encryption:**
1. **nfsKey** (Non-Forward-Secret Key): –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∫–ª—é—á
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ X25519/ML-KEM-768 –ø–∞—Ä—ã –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞

2. **pfsKey** (Perfect-Forward-Secret Key): –≠—Ñ–µ–º–µ—Ä–Ω—ã–π –∫–ª—é—á
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ MLKEM768X25519
   - –£–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ù–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç nfsKey

3. **unitedKey**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∫–ª—é—á
   ```
   unitedKey = Hash(pfsKey || nfsKey)
   ```
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –î–∞–∂–µ –µ—Å–ª–∏ ML-KEM-768 —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω –≤ –±—É–¥—É—â–µ–º, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏ nfsKey

### –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ SS/VMess:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥ (PSK)
         ‚Üì
–ú–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å:
  ‚Ä¢ –í–µ—Å—å –ø—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–µ—Å–ª–∏ –±—ã–ª –∑–∞–ø–∏—Å–∞–Ω)
  ‚Ä¢ –í–µ—Å—å –±—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
  ‚Ä¢ –ú–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å MITM –∞—Ç–∞–∫—É
```

**–†–µ—à–µ–Ω–∏–µ –≤ VLESS Encryption:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥ (–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞)
         ‚Üì
–ù–ï –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å:
  ‚Ä¢ –ü—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫ (—Ç—Ä–µ–±—É—é—Ç—Å—è —ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏, —É–∂–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã)
  ‚Ä¢ –ë—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞)
  
–ú–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å MITM —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
  ‚Ä¢ –ü–æ–ª—É—á–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ (—Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
```

**–£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã:**

| –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è | SS 2022/AEAD | VLESS Encryption |
|---------------|--------------|------------------|
| –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥ | ‚ùå –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω | ‚úÖ –¢—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–µ–Ω |
| –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–ª—é—á | ‚ùå –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –±—É–¥—É—â–∏–π MITM |
| –ö–ª–∏–µ–Ω—Ç + –°–µ—Ä–≤–µ—Ä | ‚ùå –ü–æ–ª–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è | ‚ö†Ô∏è –ë—É–¥—É—â–∏–π MITM (–ø—Ä–æ—à–ª–æ–µ –∑–∞—â–∏—â–µ–Ω–æ) |

### 1-RTT vs 0-RTT

**1-RTT (–ø–µ—Ä–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ):**
```
–ö–ª–∏–µ–Ω—Ç                           –°–µ—Ä–≤–µ—Ä
  ‚îÇ                                ‚îÇ
  ‚îú‚îÄ‚îÄ‚îÄ Client Hello ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ (nfsKey –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, —ç—Ñ–µ–º–µ—Ä–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á)
  ‚îÇ                                ‚îÇ 
  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ Server Hello ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ (—ç—Ñ–µ–º–µ—Ä–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á, ticket, padding)
  ‚îÇ                                ‚îÇ
  ‚îú‚îÄ‚îÄ‚îÄ Application Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ (unitedKey = pfsKey ‚äï nfsKey)
  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ Application Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
  ‚îÇ                                ‚îÇ
```
**–ó–∞–¥–µ—Ä–∂–∫–∞**: +1 RTT (–æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏)

**0-RTT (–ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è):**
```
–ö–ª–∏–µ–Ω—Ç                           –°–µ—Ä–≤–µ—Ä
  ‚îÇ                                ‚îÇ
  ‚îú‚îÄ‚îÄ‚îÄ Ticket Hello ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ (nfsKey –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, ticket, –¥–∞–Ω–Ω—ã–µ)
  ‚îÇ                                ‚îÇ ‚Üì –°–µ—Ä–≤–µ—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç pfsKey –∏–∑ ticket
  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ Application Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ (unitedKey, –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É)
  ‚îÇ                                ‚îÇ
```
**–ó–∞–¥–µ—Ä–∂–∫–∞**: 0 RTT (–¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–≤–æ–º –ø–∞–∫–µ—Ç–µ)

**Ticket –º–µ—Ö–∞–Ω–∏–∑–º:**
- –°–µ—Ä–≤–µ—Ä —à–∏—Ñ—Ä—É–µ—Ç pfsKey –≤ ticket
- Ticket –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 10 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è: 300-600s)
- –ö–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É 1-RTT –∏ 0-RTT
- –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è ticket - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç –∫ 1-RTT

---

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

VLESS Encryption –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∏ —Ä–µ–∂–∏–º–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ —Ç—Ä–∞—Ñ–∏–∫–∞:

### 1. Native Mode

**–í–Ω–µ—à–Ω–∏–π –≤–∏–¥**: TLSv1.3-–ø–æ–¥–æ–±–Ω—ã–π (`23 3 3 l>>8 l` –∑–∞–≥–æ–ª–æ–≤–∫–∏)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XTLS ReadV/Splice
- ‚ö†Ô∏è –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ X25519/ML-KEM-768 –≤–∏–¥–Ω—ã –≤ —Ç—Ä–∞—Ñ–∏–∫–µ
- ‚ö†Ô∏è AEAD –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–º–µ—é—Ç TLS-–ø–æ–¥–æ–±–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä—è–º–æ–µ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –¢—Ä–∞–Ω–∑–∏—Ç –±–µ–∑ DPI
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞:**
```
23 03 03 XX XX [AEAD encrypted data]
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚î¥‚îÄ Length (big-endian)
‚îÇ  ‚îî‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ TLS 1.3 version
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Application Data (23)
```

### 2. XOR Public Keys Mode (xorpub)

**–í–Ω–µ—à–Ω–∏–π –≤–∏–¥**: TLS-–ø–æ–¥–æ–±–Ω—ã–π, –Ω–æ –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω—ã

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –°–∫—Ä—ã–≤–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ X25519/ML-KEM-768
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XTLS ReadV/Splice
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead (~0.01% –Ω–∞ –∫–ª—é—á–∏)
- ‚ö†Ô∏è AEAD –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è TLS-–ø–æ–¥–æ–±–Ω—ã–º–∏

**–ü—Ä–æ—Ü–µ—Å—Å XOR:**
```
Original Public Key:  [32 bytes X25519] [1184 bytes ML-KEM-768]
                            ‚Üì XOR              ‚Üì XOR
XOR Mask:            [derived from nfsKey]
                            ‚Üì                   ‚Üì
Transmitted:         [32 bytes XORed]    [1184 bytes XORed]

–†–µ–∑—É–ª—å—Ç–∞—Ç: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π —Å–∫—Ä—ã—Ç—ã
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- DPI –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª—é—á–µ–π
- Relay —Ü–µ–ø–æ—á–∫–∏
- –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

### 3. Random Mode (random)

**–í–Ω–µ—à–Ω–∏–π –≤–∏–¥**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ç–æ–∫ –±–∞–π—Ç

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ü–æ–ª–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ XOR –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π + –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è: AES-256-CTR XOR –Ω–∞ –∫–∞–∂–¥–æ–º –ø–∞–∫–µ—Ç–µ
- ‚ö†Ô∏è Overhead: ~0.06% —Ç—Ä–∞—Ñ–∏–∫–∞ (—Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
- ‚ö†Ô∏è –ù–µ—Ç XTLS ReadV/Splice (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è XorConn)

**–ü—Ä–æ—Ü–µ—Å—Å XOR –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:**
```
TLS-like Header: 23 03 03 XX XX
                    ‚Üì XOR –∫–∞–∂–¥—ã–π –±–∞–π—Ç
Random Stream:   A7 B2 F4 C9 8E (–∏–∑ AES-256-CTR)
                    ‚Üì
Result:          8A B1 F7 YY YY (—Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å
- –ê–∫—Ç–∏–≤–Ω—ã–π DPI —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- Non-TLS –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ò—Ä–∞–Ω)
- Overhead 0.06% –ø—Ä–∏–µ–º–ª–µ–º

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –í random —Ä–µ–∂–∏–º–µ XTLS –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–±–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å), —Ç–∞–∫ –∫–∞–∫ XorConn –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ReadV/Splice.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Native | XorPub | Random |
|----------|--------|--------|--------|
| CPU overhead | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π | +0.01% | +0.06% |
| Bandwidth overhead | 0% | 0% | 0.06% |
| XTLS ReadV/Splice | ‚úÖ –ü–æ–ª–Ω–∞—è | ‚úÖ –ü–æ–ª–Ω–∞—è | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è |
| –°–∫—Ä—ã—Ç–∏–µ –∫–ª—é—á–µ–π | ‚ùå | ‚úÖ | ‚úÖ |
| –°–∫—Ä—ã—Ç–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ | ‚ùå | ‚ùå | ‚úÖ |
| DPI —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è |
| –°–∫–æ—Ä–æ—Å—Ç—å | üî• –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | üî• –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | ‚ö° –í—ã—Å–æ–∫–∞—è |

---

## –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ decryption (—Å–µ—Ä–≤–µ—Ä)

```
mlkem768x25519plus.{mode}.{ticket}.{padding}.{keys}...
‚îÇ                  ‚îÇ      ‚îÇ        ‚îÇ         ‚îÇ
‚îÇ                  ‚îÇ      ‚îÇ        ‚îÇ         ‚îî‚îÄ X25519 PrivateKey (32 bytes)
‚îÇ                  ‚îÇ      ‚îÇ        ‚îÇ            ML-KEM-768 Seed (64 bytes)
‚îÇ                  ‚îÇ      ‚îÇ        ‚îÇ            (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä)
‚îÇ                  ‚îÇ      ‚îÇ        ‚îÇ
‚îÇ                  ‚îÇ      ‚îÇ        ‚îî‚îÄ Padding –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ                  ‚îÇ      ‚îÇ
‚îÇ                  ‚îÇ      ‚îî‚îÄ –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ ticket (—Å–µ–∫—É–Ω–¥—ã)
‚îÇ                  ‚îÇ         ‚Ä¢ 600s = 600 —Å–µ–∫—É–Ω–¥ (10 –º–∏–Ω—É—Ç)
‚îÇ                  ‚îÇ         ‚Ä¢ 300-600s = —Å–ª—É—á–∞–π–Ω–æ –æ—Ç 300 –¥–æ 600
‚îÇ                  ‚îÇ         ‚Ä¢ 0s = –æ—Ç–∫–ª—é—á–∏—Ç—å 0-RTT
‚îÇ                  ‚îÇ
‚îÇ                  ‚îî‚îÄ –†–µ–∂–∏–º: native / xorpub / random
‚îÇ
‚îî‚îÄ –ü—Ä–µ—Ñ–∏–∫—Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π)
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```json
// –ë–∞–∑–æ–≤—ã–π (native, 10 –º–∏–Ω—É—Ç ticket, padding –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
"decryption": "mlkem768x25519plus.native.600s..gK3C8vW...x25519Key.xK9mP2n...mlkemSeed"

// –ë–µ–∑ 0-RTT (—Ç–æ–ª—å–∫–æ 1-RTT)
"decryption": "mlkem768x25519plus.native.0s..gK3C8vW...x25519Key.xK9mP2n...mlkemSeed"

// –°–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è ticket (5-10 –º–∏–Ω—É—Ç)
"decryption": "mlkem768x25519plus.random.300-600s..gK3C8vW...x25519Key.xK9mP2n...mlkemSeed"

// –° custom padding
"decryption": "mlkem768x25519plus.xorpub.600s.100-200-500.80-50-200.gK3C8vW...x25519Key.xK9mP2n...mlkemSeed"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ encryption (–∫–ª–∏–µ–Ω—Ç)

```
mlkem768x25519plus.{mode}.{rtt}.{padding}.{keys}...
‚îÇ                  ‚îÇ      ‚îÇ     ‚îÇ         ‚îÇ
‚îÇ                  ‚îÇ      ‚îÇ     ‚îÇ         ‚îî‚îÄ X25519 Password (32 bytes)
‚îÇ                  ‚îÇ      ‚îÇ     ‚îÇ            ML-KEM-768 Client (1184 bytes)
‚îÇ                  ‚îÇ      ‚îÇ     ‚îÇ            (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–ª—è relay)
‚îÇ                  ‚îÇ      ‚îÇ     ‚îÇ
‚îÇ                  ‚îÇ      ‚îÇ     ‚îî‚îÄ Padding –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ                  ‚îÇ      ‚îÇ
‚îÇ                  ‚îÇ      ‚îî‚îÄ –†–µ–∂–∏–º RTT: 0rtt / 1rtt
‚îÇ                  ‚îÇ         ‚Ä¢ 0rtt = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ticket –µ—Å–ª–∏ –µ—Å—Ç—å
‚îÇ                  ‚îÇ         ‚Ä¢ 1rtt = –≤—Å–µ–≥–¥–∞ 1-RTT handshake
‚îÇ                  ‚îÇ
‚îÇ                  ‚îî‚îÄ –†–µ–∂–∏–º: native / xorpub / random
‚îÇ
‚îî‚îÄ –ü—Ä–µ—Ñ–∏–∫—Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```json
// –ë–∞–∑–æ–≤—ã–π (0-RTT –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
"encryption": "mlkem768x25519plus.native.0rtt..Ft5xRjE...x25519Pass.bH4kL7q...mlkemClient"

// –¢–æ–ª—å–∫–æ 1-RTT
"encryption": "mlkem768x25519plus.native.1rtt..Ft5xRjE...x25519Pass.bH4kL7q...mlkemClient"

// –î–≤–∞ relay (—Ü–µ–ø–æ—á–∫–∞)
"encryption": "mlkem768x25519plus.xorpub.0rtt..Pass1.Client1.Pass2.Client2"
```

### Padding –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

Padding –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –¥–ª–∏–Ω—ã handshake –ø–∞–∫–µ—Ç–æ–≤ –æ—Ç –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞.

**–§–æ—Ä–º–∞—Ç –æ–¥–Ω–æ–≥–æ padding –±–ª–æ–∫–∞:**
```
probability-minDelay-maxDelay
‚îÇ           ‚îÇ        ‚îÇ
‚îÇ           ‚îÇ        ‚îî‚îÄ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (–º—Å) –ò–õ–ò –º–∞–∫—Å. —Ä–∞–∑–º–µ—Ä padding (–±–∞–π—Ç—ã)
‚îÇ           ‚îÇ
‚îÇ           ‚îî‚îÄ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (–º—Å) –ò–õ–ò –º–∏–Ω. —Ä–∞–∑–º–µ—Ä padding (–±–∞–π—Ç—ã)
‚îÇ
‚îî‚îÄ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (0-100%)
```

**–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
```
100-111-1111.75-0-111.50-0-3333
‚îÇ            ‚îÇ          ‚îÇ
‚îÇ            ‚îÇ          ‚îî‚îÄ 3-–π —ç—Ç–∞–ø: 50% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, 0-3333 –±–∞–π—Ç padding
‚îÇ            ‚îÇ
‚îÇ            ‚îî‚îÄ 2-–π —ç—Ç–∞–ø: 75% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –∑–∞–¥–µ—Ä–∂–∫–∞ 0-111 –º—Å
‚îÇ
‚îî‚îÄ 1-–π —ç—Ç–∞–ø: 100% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, 111-1111 –±–∞–π—Ç padding –ø–æ—Å–ª–µ handshake
```

**–†–∞–±–æ—Ç–∞ padding:**
```
1. Client/Server Hello –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
   ‚Üì
2. –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 100% –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 111-1111 –±–∞–π—Ç padding
   ‚Üì
3. –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 75% –∑–∞–¥–µ—Ä–∂–∫–∞ 0-111 –º—Å
   ‚Üì
4. –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 50% –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –µ—â–µ 0-3333 –±–∞–π—Ç padding
   ‚Üì
5. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
```

**Custom padding –ø—Ä–∏–º–µ—Ä—ã:**
```
// –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π padding (–±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö)
"100-500-2000.90-100-500.70-0-5000"

// –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π padding (—Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
"100-35-100"

// –ë–µ–∑ padding (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
"0"

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
".." –∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:**
- –ü–µ—Ä–≤—ã–π padding –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å 100% –∏ –º–∏–Ω–∏–º—É–º 35 –±–∞–π—Ç
- Padding –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ 1-RTT handshake
- Padding —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞, –Ω–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç fingerprinting

---

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

### CLI –∫–æ–º–∞–Ω–¥—ã Xray

#### 1. X25519 –∫–ª—é—á–∏

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –ø–∞—Ä—ã
./xray x25519

# –í—ã–≤–æ–¥:
# PrivateKey: gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d  (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞)
# Password: Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH      (–¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞)
# Hash32: a7b9c2d4e6f8g0h2i4j6k8l0m2n4o6p8      (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
./xray x25519 -i "gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d"
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- **PrivateKey**: –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ (32 –±–∞–π—Ç–∞, base64.RawURLEncoding)
  - –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `decryption` –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
  
- **Password**: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ (32 –±–∞–π—Ç–∞, base64.RawURLEncoding)
  - –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `encryption` –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
  - –ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ –Ω–µ –¥–∞–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫

- **Hash32**: BLAKE3 —Ö—ç—à –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ (32 –±–∞–π—Ç–∞)
  - –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ

#### 2. ML-KEM-768 –∫–ª—é—á–∏

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –ø–∞—Ä—ã
./xray mlkem768

# –í—ã–≤–æ–¥:
# Seed: xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞, 64 –±–∞–π—Ç–∞)
# Client: bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE... (–¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞, 1184 –±–∞–π—Ç–∞)
# Hash32: d3e5f8g0h2i4j6k8l0m2n4o6p8q0r2s4      (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ seed
./xray mlkem768 -i "xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- **Seed**: Seed –¥–ª—è ML-KEM-768 (64 –±–∞–π—Ç–∞, base64.RawURLEncoding)
  - –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏–∏
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `decryption` –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
  
- **Client**: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ (1184 –±–∞–π—Ç–∞, base64.RawURLEncoding)
  - –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `encryption` –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
  - –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

- **Hash32**: BLAKE3 —Ö—ç—à –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
  - –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 3. UUID –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ UUIDv4
./xray uuid

# –í—ã–≤–æ–¥:
# 27848739-7e62-4138-9fd3-098a63964b6b

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUIDv5 –∏–∑ —Å—Ç—Ä–æ–∫–∏
./xray uuid -i "user@example.com"

# –í—ã–≤–æ–¥:
# 5e5e6e2f-7e62-5138-9fd3-098a63964b6b
```

#### 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
./xray vlessenc

# –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª—ã:
# - vless_server.json (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
# - vless_client.json (–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
# - vless_keys.txt (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è backup)
```

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–π

```
–°–µ—Ä–≤–µ—Ä (decryption)                      –ö–ª–∏–µ–Ω—Ç (encryption)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

X25519 PrivateKey (32 –±–∞–π—Ç–∞)     ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫   X25519 Password (32 –±–∞–π—Ç–∞)
   gK3C8vWxYz9m...                          Ft5xRjE2sT3uV5w...
   [–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á]                         [–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –æ—Ç –Ω–µ–≥–æ]

ML-KEM-768 Seed (64 –±–∞–π—Ç–∞)       ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫   ML-KEM-768 Client (1184 –±–∞–π—Ç–∞)
   xK9mP2nQ5rS8tU1v...                      bH4kL7qM9nP2rS5t...
   [seed –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞]                  [–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏]

UUID                              ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫   UUID
   27848739-7e62-4138-9fd3...               27848739-7e62-4138-9fd3...
   [–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]             [—Ç–æ—Ç –∂–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä]
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
# –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω—ã
chmod 600 /etc/xray/config.json
chown root:root /etc/xray/config.json

# –ë—ç–∫–∞–ø –∫–ª—é—á–µ–π –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ
./xray x25519 > /root/xray_keys_backup.txt
chmod 400 /root/xray_keys_backup.txt
```

**–î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:**
```bash
# –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
# –ù–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (HTTPS, Signal, etc.)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
qrencode -o vless_qr.png "vless://uuid@server:port?encryption=..."
```

### –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

**–†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤):**

```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –∫–ª—é—á–∏
./xray x25519 > new_x25519.txt
./xray mlkem768 > new_mlkem768.txt

# 2. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –í –ö–û–ù–ï–¶ —Å—Ç—Ä–æ–∫–∏ decryption (–Ω–µ —É–¥–∞–ª—è—è —Å—Ç–∞—Ä—ã–µ)
"decryption": "mlkem768x25519plus.native.600s..oldX25519.oldMLKEM.newX25519.newMLKEM"

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä (—Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
systemctl restart xray

# 4. –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏

# 5. –ß–µ—Ä–µ–∑ 1-2 –Ω–µ–¥–µ–ª–∏ —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏
"decryption": "mlkem768x25519plus.native.600s..newX25519.newMLKEM"
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### 1. –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Native + TCP)

**–°–µ—Ä–≤–µ—Ä:**
```json
{
  "log": {
    "loglevel": "warning"
  },
  "inbounds": [
    {
      "port": 8443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "27848739-7e62-4138-9fd3-098a63964b6b",
            "email": "user1@example.com"
          }
        ],
        "decryption": "mlkem768x25519plus.native.600s.100-111-1111.75-0-111.50-0-3333.gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d.xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",
      "settings": {}
    }
  ]
}
```

**–ö–ª–∏–µ–Ω—Ç:**
```json
{
  "log": {
    "loglevel": "warning"
  },
  "inbounds": [
    {
      "port": 1080,
      "protocol": "socks",
      "settings": {
        "udp": true
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "server.example.com",
            "port": 8443,
            "users": [
              {
                "id": "27848739-7e62-4138-9fd3-098a63964b6b",
                "encryption": "mlkem768x25519plus.native.0rtt.100-111-1111.75-0-111.50-0-3333.Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH.bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ]
}
```

### 2. –° XTLS Vision (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

**–°–µ—Ä–≤–µ—Ä:**
```json
{
  "inbounds": [
    {
      "port": 8443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "27848739-7e62-4138-9fd3-098a63964b6b",
            "flow": "xtls-rprx-vision",
            "email": "user1@example.com"
          }
        ],
        "decryption": "mlkem768x25519plus.native.600s..gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d.xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",
      "settings": {}
    }
  ]
}
```

**–ö–ª–∏–µ–Ω—Ç:**
```json
{
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "server.example.com",
            "port": 8443,
            "users": [
              {
                "id": "27848739-7e62-4138-9fd3-098a63964b6b",
                "flow": "xtls-rprx-vision",
                "encryption": "mlkem768x25519plus.native.0rtt..Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH.bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ]
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ XTLS:**
- ‚úÖ ReadV: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ —Å–æ–∫–µ—Ç–∞ (–º–µ–Ω—å—à–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤)
- ‚úÖ Splice: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ kernel space –Ω–∞ Linux (zero-copy)
- ‚úÖ –ü—Ä–æ–±–∏–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ handshake –¥–ª—è TLS —Ç—Ä–∞—Ñ–∏–∫–∞
- üöÄ ~30-50% –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 3. Random —Ä–µ–∂–∏–º (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å)

**–°–µ—Ä–≤–µ—Ä:**
```json
{
  "inbounds": [
    {
      "port": 8443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "27848739-7e62-4138-9fd3-098a63964b6b",
            "flow": "xtls-rprx-vision"
          }
        ],
        "decryption": "mlkem768x25519plus.random.600s.100-111-1111.75-0-111.50-0-3333.gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d.xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ]
}
```

**–ö–ª–∏–µ–Ω—Ç:**
```json
{
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "server.example.com",
            "port": 8443,
            "users": [
              {
                "id": "27848739-7e62-4138-9fd3-098a63964b6b",
                "flow": "xtls-rprx-vision",
                "encryption": "mlkem768x25519plus.random.0rtt.100-111-1111.75-0-111.50-0-3333.Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH.bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ]
}
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –í random —Ä–µ–∂–∏–º–µ XTLS —Ä–∞–±–æ—Ç–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ (—Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å), —Ç–∞–∫ –∫–∞–∫ XorConn –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π ReadV/Splice.

### 4. –ß–µ—Ä–µ–∑ XHTTP (CDN/WebSocket –∑–∞–º–µ–Ω–∞)

**–°–µ—Ä–≤–µ—Ä:**
```json
{
  "inbounds": [
    {
      "port": 443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "27848739-7e62-4138-9fd3-098a63964b6b",
            "flow": "xtls-rprx-vision"
          }
        ],
        "decryption": "mlkem768x25519plus.native.600s..gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d.xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
      },
      "streamSettings": {
        "network": "xhttp",
        "xhttpSettings": {
          "mode": "stream-up",
          "host": "example.com",
          "path": "/api/v1/data"
        }
      }
    }
  ]
}
```

**–ö–ª–∏–µ–Ω—Ç:**
```json
{
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "cdn.example.com",
            "port": 443,
            "users": [
              {
                "id": "27848739-7e62-4138-9fd3-098a63964b6b",
                "flow": "xtls-rprx-vision",
                "encryption": "mlkem768x25519plus.native.0rtt..Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH.bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "xhttp",
        "xhttpSettings": {
          "mode": "stream-up",
          "host": "example.com",
          "path": "/api/v1/data"
        }
      }
    }
  ]
}
```

**–†–µ–∂–∏–º—ã XHTTP:**
- `stream-up`: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ HTTP/2 stream (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å XTLS)
- `stream-one`: –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –Ω–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `packet-up`: –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

### 5. –¶–µ–ø–æ—á–∫–∞ relay (–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∞)

**–ö–ª–∏–µ–Ω—Ç ‚Üí Relay ‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä**

**Relay —Å–µ—Ä–≤–µ—Ä (—Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã–π):**
```json
{
  "inbounds": [
    {
      "port": 8443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "11111111-1111-1111-1111-111111111111"
          }
        ],
        "decryption": "mlkem768x25519plus.xorpub.600s..relayX25519Private.relayMLKEMSeed"
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "final-server.com",
            "port": 8443,
            "users": [
              {
                "id": "22222222-2222-2222-2222-222222222222",
                "encryption": "mlkem768x25519plus.xorpub.0rtt..finalX25519Password.finalMLKEMClient"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "tcp"
      }
    }
  ]
}
```

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:**
```json
{
  "inbounds": [
    {
      "port": 8443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "22222222-2222-2222-2222-222222222222"
          }
        ],
        "decryption": "mlkem768x25519plus.xorpub.600s..finalX25519Private.finalMLKEMSeed"
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom"
    }
  ]
}
```

**–ö–ª–∏–µ–Ω—Ç (–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –æ–±–æ–∏–º):**
```json
{
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "relay-server.com",
            "port": 8443,
            "users": [
              {
                "id": "11111111-1111-1111-1111-111111111111",
                "encryption": "mlkem768x25519plus.xorpub.0rtt..relayX25519Pass.relayMLKEMClient.finalX25519Pass.finalMLKEMClient"
              }
            ]
          }
        ]
      }
    }
  ]
}
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ö–ª–∏–µ–Ω—Ç —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è relay —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–≤–æ–π –ø–∞—Ä–æ–π –∫–ª—é—á–µ–π
2. –í–Ω—É—Ç—Ä–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤—Ç–æ—Ä–æ–π –ø–∞—Ä–æ–π –∫–ª—é—á–µ–π
3. Relay –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–ª–æ–π (–Ω–µ –∏–º–µ–µ—Ç finalX25519Private)
4. –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 6. –¢–æ–ª—å–∫–æ 1-RTT (–±–µ–∑ 0-RTT ticket)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞–Ω–æ–∏–¥–∞–ª—å–Ω–æ—Å—Ç—å
- –ö–æ—Ä–æ—Ç–∫–∏–µ —Å–µ—Å—Å–∏–∏ (–Ω–µ—Ç —Å–º—ã—Å–ª–∞ –≤ ticket)
- –ò–∑–±–µ–∂–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–°–µ—Ä–≤–µ—Ä:**
```json
{
  "settings": {
    "clients": [
      {
        "id": "27848739-7e62-4138-9fd3-098a63964b6b"
      }
    ],
    "decryption": "mlkem768x25519plus.native.0s..gK3C8vWxYz9mN4pL7qR2sT6uV8wA1bC3d.xK9mP2nQ5rS8tU1vW4xY7zA0bC3dE6fG9hH2jK5lM8nP1qR4sT7uV0wX3yZ6aC"
  }
}
```
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: `600s` ‚Üí `0s`

**–ö–ª–∏–µ–Ω—Ç:**
```json
{
  "users": [
    {
      "id": "27848739-7e62-4138-9fd3-098a63964b6b",
      "encryption": "mlkem768x25519plus.native.1rtt..Ft5xRjE2sT3uV5wX8yZ1aC4bD7eF0gH.bH4kL7qM9nP2rS5tU8vW1xY4zA7bC0dE"
    }
  ]
}
```
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: `0rtt` ‚Üí `1rtt`

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏

### –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | VLESS Encryption | REALITY/TLS | SS 2022 | SS AEAD | VMess AEAD |
|----------|------------------|-------------|---------|---------|------------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** |
| –ö–ª–∏–µ–Ω—Ç config –∑–∞—â–∏—Ç–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| Perfect Forward Secrecy | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –ö–≤–∞–Ω—Ç–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å | ‚úÖ ML-KEM-768 | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –ó–∞—â–∏—Ç–∞ –æ—Ç replay | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è | ‚ö†Ô∏è "–ü–æ–¥–≤–∏–∂–∫–∞ —Ü–≤–µ—Ç–∫–∞" | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ |
| –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ MITM | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚ùå PSK | ‚ùå PSK | ‚ùå PSK |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** |
| RTT overhead | 0-RTT | 1-RTT | 0-RTT | 0-RTT | 0-RTT |
| –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | O(1) ticket | O(1) UUID | O(1) PSK | O(n) –ø–µ—Ä–µ–±–æ—Ä | O(n) –ø–µ—Ä–µ–±–æ—Ä |
| Extra AEAD length | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚úÖ +13 –±–∞–π—Ç | ‚úÖ +13 –±–∞–π—Ç | ‚ùå –ù–µ—Ç |
| XTLS —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | ‚úÖ ReadV/Splice | ‚úÖ ReadV/Splice | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –°–∫–æ—Ä–æ—Å—Ç—å (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ) | 110% | 110% | 100% | 100% | 100% |
| **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** |
| –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π | TLS 1.3 | Random | Random | Random |
| –î–ª—è –ø—Ä—è–º–æ–≥–æ –æ–±—Ö–æ–¥–∞ GFW | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –¢—Ä–µ–±—É–µ—Ç –¥–æ–º–µ–Ω | ‚ùå –ù–µ—Ç | ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –¢—Ä–µ–±—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ö†Ô∏è –î–∞ (~1 –º–∏–Ω) | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ (¬±2 –º–∏–Ω) |
| XUDP/UoT | ‚úÖ –ê–≤—Ç–æ | ‚úÖ –ê–≤—Ç–æ | ‚ùå –í–Ω–µ—à–Ω–∏–π | ‚ùå –í–Ω–µ—à–Ω–∏–π | ‚ö†Ô∏è –î–µ—Ñ–µ–∫—Ç–Ω—ã–π |

### –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 1. Client Config Security

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∏–ª client config —á–µ—Ä–µ–∑ —Ñ–∏—à–∏–Ω–≥/clipboard/inputmethod

| –ü—Ä–æ—Ç–æ–∫–æ–ª | –ß—Ç–æ –º–æ–∂–µ—Ç –∞—Ç–∞–∫—É—é—â–∏–π |
|----------|-------------------|
| **SS 2022/AEAD** | ‚ùå –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –ø—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫<br>‚ùå –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –±—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫<br>‚ùå –í—ã–ø–æ–ª–Ω–∏—Ç—å MITM |
| **VMess** | ‚ùå –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –ø—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫<br>‚ùå –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –±—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫<br>‚ùå –í—ã–ø–æ–ª–Ω–∏—Ç—å MITM |
| **VLESS Encryption** | ‚úÖ –ü—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–µ–Ω (PFS)<br>‚úÖ –ë—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è server private key)<br>‚úÖ MITM –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ server private key |
| **REALITY** | ‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ VLESS Encryption |

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?**
```
–°–ø–æ—Å–æ–±—ã —É—Ç–µ—á–∫–∏ client config:
‚Ä¢ Clipboard hijacking (–º–Ω–æ–≥–∏–µ VPN –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
‚Ä¢ Keylogger / Input method upload
‚Ä¢ Screenshot/screen sharing
‚Ä¢ Cloud backup –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è
‚Ä¢ –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç
‚Ä¢ –ê–Ω—Ç–∏—Ñ—Ä–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ö–∏—Ç–∞–π)
```

#### 2. Perfect Forward Secrecy

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –ê—Ç–∞–∫—É—é—â–∏–π –∑–∞–ø–∏—Å—ã–≤–∞–ª —Ç—Ä–∞—Ñ–∏–∫ 6 –º–µ—Å—è—Ü–µ–≤, –∑–∞—Ç–µ–º –ø–æ–ª—É—á–∏–ª server private key

| –ü—Ä–æ—Ç–æ–∫–æ–ª | –ú–æ–∂–µ—Ç –ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫? |
|----------|----------------------------------------|
| **SS 2022/AEAD** | ‚ùå –î–∞, –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ |
| **VMess** | ‚ùå –î–∞, –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ |
| **VLESS Encryption** | ‚úÖ –ù–µ—Ç, —ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã |
| **REALITY** | ‚úÖ –ù–µ—Ç, —ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã |

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ PFS:**
```
VLESS Encryption:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–µ—Å—Å–∏—è1‚îÇ –°–µ—Å—Å–∏—è2‚îÇ –°–µ—Å—Å–∏—è3‚îÇ –°–µ—Å—Å–∏—è4‚îÇ –°–µ—Å—Å–∏—è5‚îÇ
‚îÇ  pfs1  ‚îÇ  pfs2  ‚îÇ  pfs3  ‚îÇ  pfs4  ‚îÇ  pfs5  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    –£–Ω–∏—á—Ç–æ–∂–µ–Ω—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π 10-–º–∏–Ω —Å–µ—Å—Å–∏–∏

–ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è server key –≤ –º–æ–º–µ–Ω—Ç –°–µ—Å—Å–∏—è5:
‚Ä¢ –°–µ—Å—Å–∏—è 1-4: –¢—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–µ–Ω ‚úÖ
‚Ä¢ –°–µ—Å—Å–∏—è 5+: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ MITM ‚ö†Ô∏è
```

```
SS/VMess (PSK):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–µ—Å—Å–∏—è1‚îÇ –°–µ—Å—Å–∏—è2‚îÇ –°–µ—Å—Å–∏—è3‚îÇ –°–µ—Å—Å–∏—è4‚îÇ –°–µ—Å—Å–∏—è5‚îÇ
‚îÇ   PSK  ‚îÇ   PSK  ‚îÇ   PSK  ‚îÇ   PSK  ‚îÇ   PSK  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –≤—Å–µ–≥–¥–∞

–ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è PSK:
‚Ä¢ –°–µ—Å—Å–∏—è 1-5: –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω ‚ùå
```

#### 3. Quantum Resistance

**–£–≥—Ä–æ–∑–∞**: –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –º–æ–≥—É—Ç –≤–∑–ª–æ–º–∞—Ç—å X25519 —á–µ—Ä–µ–∑ –∞–ª–≥–æ—Ä–∏—Ç–º –®–æ—Ä–∞

| –ü—Ä–æ—Ç–æ–∫–æ–ª | –£—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã |
|----------|----------------|
| **SS/VMess** | ‚ùå –ù–µ—Ç KEM, —Ç–æ–ª—å–∫–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (AES/ChaCha) |
| **TLS 1.3** | ‚ö†Ô∏è X25519 —É—è–∑–≤–∏–º –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º |
| **REALITY** | ‚ö†Ô∏è X25519 + ML-DSA-65 (–ø–æ–¥–ø–∏—Å—å –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤–∞, –Ω–æ KEM –Ω–µ—Ç) |
| **VLESS Encryption** | ‚úÖ **MLKEM768X25519** - –≥–∏–±—Ä–∏–¥–Ω—ã–π KEM |

**–ê—Ç–∞–∫–∞ "–∑–∞–ø–∏—Å–∞—Ç—å —Å–µ–π—á–∞—Å, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–º":**
```
–¢–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç (2024):
  –ê—Ç–∞–∫—É—é—â–∏–π –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫

2034 (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏):
  –ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä –º–æ–∂–µ—Ç –≤–∑–ª–æ–º–∞—Ç—å X25519

–ü—Ä–æ—Ç–æ–∫–æ–ª            –†–µ–∑—É–ª—å—Ç–∞—Ç –∞—Ç–∞–∫–∏
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
TLS (X25519 only)   ‚ùå –¢—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω
VLESS Encryption    ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ ML-KEM-768
                       (—Ç—Ä–µ–±—É–µ—Ç –≤–∑–ª–æ–º –æ–±–æ–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤)
```

**–î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ MLKEM768X25519:**
```
unitedKey = Hash(mlkem_shared_secret || x25519_shared_secret)
                       ‚îÇ                      ‚îÇ
                       ‚îÇ                      ‚îî‚îÄ –ë—ã—Å—Ç—Ä—ã–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π
                       ‚îÇ
                       ‚îî‚îÄ –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–π (NIST —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

–î–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –Ω—É–∂–Ω–æ –≤–∑–ª–æ–º–∞—Ç—å –û–ë–ê:
‚Ä¢ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä –¥–ª—è X25519
‚Ä¢ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è ML-KEM-768
```

#### 4. Replay Protection

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –ê—Ç–∞–∫—É—é—â–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏–ª –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–∞–∫–µ—Ç—ã

| –ü—Ä–æ—Ç–æ–∫–æ–ª | –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
|----------|----------------|---------------|
| **SS AEAD** | Bloom filter salt | ‚ö†Ô∏è –ù–µ–ø–æ–ª–Ω–∞—è (–Ω–µ—Ç persist, "–ø–æ–¥–≤–∏–∂–∫–∞ —Ü–≤–µ—Ç–∫–∞") |
| **SS 2022** | Timestamp + salt map | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç sync –≤—Ä–µ–º–µ–Ω–∏, –Ω–µ—Ç persist –ø–æ—Å–ª–µ reboot |
| **VMess** | Timestamp –≤ —à–∏—Ñ—Ä–µ | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç ¬±2 –º–∏–Ω—É—Ç—ã sync |
| **VLESS Encryption** | nfsKey map + ticket expiry | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏, auto cleanup) |

**–ü—Ä–æ–±–ª–µ–º–∞ SS AEAD "–ø–æ–¥–≤–∏–∂–∫–∞ —Ü–≤–µ—Ç–∫–∞" ([Issue #183](https://github.com/shadowsocks/shadowsocks-org/issues/183)):**
```
–ê—Ç–∞–∫—É—é—â–∏–π:
1. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç –æ—Ç Client A –∫ Server
2. –ú–µ–Ω—è–µ—Ç destination IP –≤ –ø–∞–∫–µ—Ç–µ
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ Server B

Server B:
‚Ä¢ –í–∏–¥–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π –ø–∞–∫–µ—Ç (salt –µ—â–µ –Ω–µ –≤ bloom filter)
‚Ä¢ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç
‚Ä¢ –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ Client A

–†–µ–∑—É–ª—å—Ç–∞—Ç: MITM –±–µ–∑ –∑–Ω–∞–Ω–∏—è PSK!
```

**VLESS Encryption –∑–∞—â–∏—Ç–∞:**
```
0-RTT –ø–∞–∫–µ—Ç:
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ ticket      ‚îÇ ‚îÄ‚îÄ‚ñ∫ O(1) lookup –≤ map[ticketHash]pfsKey
  ‚îÇ nfsKeyHash  ‚îÇ ‚îÄ‚îÄ‚ñ∫ O(1) lookup –≤ map[nfsKeyHash]timestamp
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Replay –∞—Ç–∞–∫–∞:
  ‚Ä¢ nfsKeyHash —É–∂–µ –≤ map ‚Üí –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ
  ‚Ä¢ ticket expired (>10 min) ‚Üí –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ
  ‚Ä¢ map auto-cleanup –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
  ‚Ä¢ –ù–µ —Ç—Ä–µ–±—É–µ—Ç clock sync –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**Benchmark –Ω–∞ Intel Core i7-12700K (AES-NI, PCLMUL):**

| –û–ø–µ—Ä–∞—Ü–∏—è | VLESS Enc (native) | SS 2022 | –†–∞–∑–Ω–∏—Ü–∞ |
|----------|-------------------|---------|---------|
| –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ data (per call) | 1x AEAD call | 2x AEAD calls | **-50% overhead** |
| –†–∞–∑–º–µ—Ä overhead | 5 bytes header | 5 + 16 bytes | **-13 bytes/packet** |
| Throughput (single core) | ~8.5 Gbps | ~7.8 Gbps | **+10% faster** |

**–ü—Ä–∏—á–∏–Ω–∞**: VLESS Encryption –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π AEAD –¥–ª—è length field.

```
SS 2022 –ø–∞–∫–µ—Ç:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AEAD(length)   ‚îÇ AEAD(data)       ‚îÇ
‚îÇ 2+16 bytes     ‚îÇ N+16 bytes       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   ^overhead        ^main data
   
   –î–≤–∞ AEAD call –Ω–∞ –∫–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç

VLESS Encryption –ø–∞–∫–µ—Ç:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5 b  ‚îÇ AEAD(data)       ‚îÇ
‚îÇ XOR  ‚îÇ N+16 bytes       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   ^0.06%    ^main data
   
   –û–¥–∏–Ω AEAD call –Ω–∞ –∫–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç
```

#### XTLS ReadV/Splice –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

**–ë–µ–∑ XTLS (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ):**
```
User space:     [Application] ‚îÄ‚îÄcopy‚îÄ‚îÄ‚ñ∫ [Proxy buffer] ‚îÄ‚îÄcopy‚îÄ‚îÄ‚ñ∫ [Encrypt buffer]
                                                                         ‚îÇ
Kernel space:                                                     copy   ‚ñº
                                                              [Socket buffer] ‚îÄ‚îÄ‚ñ∫ Network

–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π: 3x
–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π: 100% —Ç—Ä–∞—Ñ–∏–∫–∞
```

**–° XTLS (–ø–æ—Å–ª–µ handshake):**
```
User space:     [Application] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ [Proxy]
                                                                       ‚îÇ
Kernel space:                                                 splice   ‚ñº
                                                              [Socket buffer] ‚îÄ‚îÄ‚ñ∫ Network

–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π: 0x (kernel splice)
–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π: ~5% (—Ç–æ–ª—å–∫–æ handshake + non-TLS)
```

**Benchmark —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (localhost loopback, TLS 1.3 —Ç—Ä–∞—Ñ–∏–∫):**

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | Throughput | CPU Usage | Latency |
|--------------|-----------|-----------|---------|
| SS 2022 (AES-256-GCM) | 7.8 Gbps | 95% | 0.5 ms |
| VLESS Enc native | 8.6 Gbps | 92% | 0.45 ms |
| VLESS Enc + XTLS ReadV | 25 Gbps | 45% | 0.15 ms |
| VLESS Enc + XTLS Splice | **40 Gbps** | **15%** | **0.08 ms** |

**–í—ã–≤–æ–¥**: XTLS –¥–∞–µ—Ç **3-5x** –ø—Ä–∏—Ä–æ—Å—Ç –Ω–∞ TLS —Ç—Ä–∞—Ñ–∏–∫–µ (95% web traffic).

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Threat Model

**–ß—Ç–æ VLESS Encryption –∑–∞—â–∏—â–∞–µ—Ç:**
- ‚úÖ –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞ (AES-256-GCM / ChaCha20-Poly1305)
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (AEAD authentication tags)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞—Ç–∞–∫ (–ø–æ–¥–º–µ–Ω–∞, MITM)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (–¥–∞–∂–µ –≤ –±—É–¥—É—â–µ–º —Å –∫–≤–∞–Ω—Ç–æ–≤—ã–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç replay –∞—Ç–∞–∫ (nfsKey map + ticket expiry)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —Å–ª—É—á–∞–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ client config

**–ß–µ–≥–æ VLESS Encryption –ù–ï –∑–∞—â–∏—â–∞–µ—Ç:**
- ‚ùå Fingerprinting –Ω–∞ —É—Ä–æ–≤–Ω–µ timing/packet size (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ padding)
- ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–æ IP/–ø–æ—Ä—Ç—É (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CDN –∏–ª–∏ REALITY –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞)
- ‚ùå Active probing attacks (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ REALITY)
- ‚ùå –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ (malware –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ/—Å–µ—Ä–≤–µ—Ä–µ)

### –í–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫ –∏ –∑–∞—â–∏—Ç–∞

#### 1. Man-in-the-Middle (MITM)

**–ê—Ç–∞–∫–∞:**
```
Client ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ [Attacker] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Server
               –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç
               –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç
```

**–ó–∞—â–∏—Ç–∞:**
- nfsKey –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∫–∞–Ω–∞–ª–æ–º
- –°–µ—Ä–≤–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ nfsKey + pfsKey
- –ê—Ç–∞–∫—É—é—â–∏–π –±–µ–∑ server private key –Ω–µ –º–æ–∂–µ—Ç –∏–º–ø–µ—Ä—Å–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
- –î–∞–∂–µ –µ—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∏–ª client config, –Ω—É–∂–µ–Ω server private key –¥–ª—è MITM

**–í–µ—Ä–¥–∏–∫—Ç**: ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞)

#### 2. Replay Attack

**–ê—Ç–∞–∫–∞:**
```
1. –ê—Ç–∞–∫—É—é—â–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –æ—Ç Client
2. –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –∏—Ö –∫ Server –ø–æ–∑–∂–µ
```

**–ó–∞—â–∏—Ç–∞ VLESS Encryption:**
```go
// 0-RTT packet processing
ticketHash := BLAKE3(encryptedTicket)
if _, exists := server.ticketMap[ticketHash]; !exists {
    return errors.New("unknown ticket")
}

nfsKeyHash := BLAKE3(encryptedNfsKey)
if _, exists := server.nfsKeyMap[nfsKeyHash]; exists {
    return errors.New("replay detected")
}
server.nfsKeyMap[nfsKeyHash] = currentTime

// Auto cleanup –ø–æ—Å–ª–µ 10 –º–∏–Ω—É—Ç
go cleanupOldEntries()
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Map nfsKeyHash –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ –∂–µ nfsKey
- Ticket expiry –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ replay
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç clock sync (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç VMess)
- Persist –Ω–µ –Ω—É–∂–µ–Ω (–∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏)

**–í–µ—Ä–¥–∏–∫—Ç**: ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç replay

#### 3. Traffic Analysis

**–ê—Ç–∞–∫–∞:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
‚Ä¢ –†–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤
‚Ä¢ Timing –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
‚Ä¢ –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ç—Ä–∞—Ñ–∏–∫–∞
```

**–ó–∞—â–∏—Ç–∞:**
- **Padding** –Ω–∞ handshake –º–∞—Å–∫–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä—ã
- **Random delays** –º–∞—Å–∫–∏—Ä—É—é—Ç timing
- **XTLS** –¥–µ–ª–∞–µ—Ç data –ø–∞–∫–µ—Ç—ã –Ω–µ–æ—Ç–ª–∏—á–∏–º—ã–º–∏ –æ—Ç TLS

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã:**
```json
"decryption": "mlkem768x25519plus.random.600s.100-500-2000.80-100-500.70-0-3000.keys..."
                                                ‚îÇ            ‚îÇ           ‚îÇ
                                                ‚îÇ            ‚îÇ           ‚îî‚îÄ 70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –µ—â–µ 0-3000 –±–∞–π—Ç
                                                ‚îÇ            ‚îî‚îÄ 80% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –∑–∞–¥–µ—Ä–∂–∫–∞ 100-500 –º—Å
                                                ‚îî‚îÄ 100% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, 500-2000 –±–∞–π—Ç padding
```

**–í–µ—Ä–¥–∏–∫—Ç**: ‚ö†Ô∏è –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ (padding –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥ —Å—Ü–µ–Ω–∞—Ä–∏–π)

#### 4. Timing Attacks

**–ê—Ç–∞–∫–∞:**
```
–ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:
‚Ä¢ –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
‚Ä¢ –¢–∏–ø–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚Ä¢ –†–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
```

**–ó–∞—â–∏—Ç–∞:**
- Constant-time –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ crypto (AES-GCM, ChaCha20)
- –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ª—é–±–æ–≥–æ nfsKey (hash lookup O(1))
- Random padding delays –º–∞—Å–∫–∏—Ä—É—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É

**–í–µ—Ä–¥–∏–∫—Ç**: ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ (constant-time crypto)

#### 5. Forward Secrecy Compromise

**–ê—Ç–∞–∫–∞:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∏–ª:
‚Ä¢ Server private key (X25519 + ML-KEM-768)
‚Ä¢ –ó–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –∑–∞ –ø—Ä–æ—à–ª—ã–µ –º–µ—Å—è—Ü—ã
```

**–ß—Ç–æ –º–æ–∂–µ—Ç –∞—Ç–∞–∫—É—é—â–∏–π:**
```
VLESS Encryption:
  ‚îú‚îÄ –ü—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫: ‚úÖ –ó–∞—â–∏—â–µ–Ω (PFS, —ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã)
  ‚îú‚îÄ –¢–µ–∫—É—â–∏–µ —Å–µ—Å—Å–∏–∏: ‚ö†Ô∏è –ú–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å (–∑–Ω–∞–µ—Ç server key)
  ‚îî‚îÄ –ë—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫: ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å MITM

SS 2022/VMess:
  ‚îú‚îÄ –ü—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫: ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç—É–ø–µ–Ω (PSK)
  ‚îú‚îÄ –¢–µ–∫—É—â–∏–µ —Å–µ—Å—Å–∏–∏: ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç—É–ø–µ–Ω
  ‚îî‚îÄ –ë—É–¥—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫: ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç—É–ø–µ–Ω
```

**–í–µ—Ä–¥–∏–∫—Ç**: ‚úÖ –ü—Ä–æ—à–ª—ã–π —Ç—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–µ–Ω Perfect Forward Secrecy

### Security Best Practices

#### 1. –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚Ä¢ –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –∫–∞–∂–¥—ã–µ 3-6 –º–µ—Å—è—Ü–µ–≤
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
‚Ä¢ –•—Ä–∞–Ω–∏—Ç–µ –±—ç–∫–∞–ø—ã –∫–ª—é—á–µ–π –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ (offline)
```

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–æ—Ç–∞—Ü–∏–∏:**
```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –∫–ª—é—á–∏
./xray x25519 > new_keys_2024_06.txt
./xray mlkem768 >> new_keys_2024_06.txt

# 2. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –≤ –∫–æ–Ω—Ñ–∏–≥ (–Ω–µ —É–¥–∞–ª—è—è —Å—Ç–∞—Ä—ã–µ)
"decryption": "mlkem768x25519plus.native.600s..oldX25519.oldMLKEM.newX25519.newMLKEM"

# 3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ (2-4 –Ω–µ–¥–µ–ª–∏)

# 4. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏
"decryption": "mlkem768x25519plus.native.600s..newX25519.newMLKEM"

# 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ —É–Ω–∏—á—Ç–æ–∂–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏
shred -vfz -n 10 old_keys_2024_01.txt
```

#### 2. Ticket lifetime

**–í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ ticket:**
```
–ö–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è (60-300s):
  ‚úÖ –ú–µ–Ω—å—à–µ window –¥–ª—è –∞—Ç–∞–∫
  ‚úÖ –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ nfsKey map
  ‚ùå –ë–æ–ª—å—à–µ 1-RTT handshakes (–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)

–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (300-600s):
  ‚úÖ –ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è (600-1800s):
  ‚úÖ –ú–µ–Ω—å—à–µ overhead –æ—Ç handshakes
  ‚ùå –ë–æ–ª—å—à–µ memory –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  ‚ùå –ë–æ–ª—å—à–µ window –¥–ª—è –∞—Ç–∞–∫
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: `600s` (10 –º–∏–Ω—É—Ç) - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å.

#### 3. Padding —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

**–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ (CDN, —Ç—Ä–∞–Ω–∑–∏—Ç):**
```
"100-111-1111"  // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π padding
```

**–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ (non-TLS):**
```
"100-111-1111.75-0-111.50-0-3333"  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

**–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ (–∞–∫—Ç–∏–≤–Ω—ã–π DPI):**
```
"100-500-2000.90-100-500.80-0-5000"  // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π padding
```

#### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
```go
// Xray logs
2024/06/15 10:30:45 [Warning] VLESS: replay detected from IP 192.168.1.100
2024/06/15 10:30:46 [Warning] VLESS: unknown ticket from IP 192.168.1.100
2024/06/15 10:30:47 [Warning] VLESS: invalid nfsKey from IP 192.168.1.100
```

**–†–µ–∞–∫—Ü–∏—è:**
```bash
# 1. Ban IP —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
iptables -A INPUT -s 192.168.1.100 -j DROP

# 2. –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π –µ—Å–ª–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é
./xray x25519 > emergency_keys.txt

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
tail -f /var/log/xray/access.log | grep "replay\|unknown ticket"
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

#### 1-RTT Client Hello

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ivAndRelays (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞)                             ‚îÇ
‚îÇ   ‚îú‚îÄ relay count (1 –±–∞–π—Ç)                                  ‚îÇ
‚îÇ   ‚îú‚îÄ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ relay:                                    ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ X25519 ephemeral public (32 –±–∞–π—Ç–∞)               ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ ML-KEM-768 ciphertext (1088 –±–∞–π—Ç)                ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ relay info encrypted (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)                 ‚îÇ
‚îÇ   ‚îî‚îÄ (XOR –µ—Å–ª–∏ xorpub/random —Ä–µ–∂–∏–º)                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Header (5 –±–∞–π—Ç)                                            ‚îÇ
‚îÇ   ‚îú‚îÄ 23 03 03 (TLS 1.3 Application Data)                  ‚îÇ
‚îÇ   ‚îî‚îÄ length (2 –±–∞–π—Ç–∞, big-endian)                          ‚îÇ
‚îÇ   (XOR –µ—Å–ª–∏ random —Ä–µ–∂–∏–º)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (nfsKey):                                   ‚îÇ
‚îÇ   ‚îú‚îÄ payload length (2 –±–∞–π—Ç–∞)                              ‚îÇ
‚îÇ   ‚îú‚îÄ X25519 client ephemeral public (32 –±–∞–π—Ç–∞)            ‚îÇ
‚îÇ   ‚îú‚îÄ ML-KEM-768 client ciphertext (1088 –±–∞–π—Ç)             ‚îÇ
‚îÇ   ‚îú‚îÄ padding (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º)                   ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Padding Data (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ padding –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)         ‚îÇ
‚îÇ   ‚îú‚îÄ Random bytes                                          ‚îÇ
‚îÇ   ‚îî‚îÄ –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–†–∞–∑–º–µ—Ä: ~1200-3500 –±–∞–π—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç padding –∏ —Ä–µ–∂–∏–º–∞)
```

#### 1-RTT Server Hello

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Header (5 –±–∞–π—Ç)                                            ‚îÇ
‚îÇ   ‚îú‚îÄ 23 03 03                                              ‚îÇ
‚îÇ   ‚îî‚îÄ length (2 –±–∞–π—Ç–∞)                                      ‚îÇ
‚îÇ   (XOR –µ—Å–ª–∏ random —Ä–µ–∂–∏–º)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (nfsKey):                                   ‚îÇ
‚îÇ   ‚îú‚îÄ X25519 server ephemeral public (32 –±–∞–π—Ç–∞)            ‚îÇ
‚îÇ   ‚îú‚îÄ ML-KEM-768 server ciphertext (1088 –±–∞–π—Ç)             ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (unitedKey = pfsKey ‚äï nfsKey):             ‚îÇ
‚îÇ   ‚îú‚îÄ ticket (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π pfsKey + timestamp)            ‚îÇ
‚îÇ   ‚îú‚îÄ ticket validity (4 –±–∞–π—Ç–∞, —Å–µ–∫—É–Ω–¥—ã)                    ‚îÇ
‚îÇ   ‚îú‚îÄ padding (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)                                  ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Padding Data (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–†–∞–∑–º–µ—Ä: ~1200-3500 –±–∞–π—Ç
```

#### 0-RTT Ticket Hello (–ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ivAndRelays (–µ—Å–ª–∏ –µ—Å—Ç—å relay chain)                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Header (5 –±–∞–π—Ç)                                            ‚îÇ
‚îÇ   ‚îú‚îÄ 23 03 03                                              ‚îÇ
‚îÇ   ‚îî‚îÄ length (2 –±–∞–π—Ç–∞)                                      ‚îÇ
‚îÇ   (XOR –µ—Å–ª–∏ random —Ä–µ–∂–∏–º)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (nfsKey):                                   ‚îÇ
‚îÇ   ‚îú‚îÄ payload length (2 –±–∞–π—Ç–∞)                              ‚îÇ
‚îÇ   ‚îú‚îÄ ticket (–æ—Ç Server Hello)                              ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (unitedKey, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–∑ ticket):     ‚îÇ
‚îÇ   ‚îú‚îÄ VLESS protocol header                                 ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ version (1 –±–∞–π—Ç)                                  ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ UUID (16 –±–∞–π—Ç)                                    ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ addons length (1 –±–∞–π—Ç)                            ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ addons (–µ—Å–ª–∏ –µ—Å—Ç—å flow)                           ‚îÇ
‚îÇ   ‚îú‚îÄ command (1 –±–∞–π—Ç: TCP/UDP/Mux)                         ‚îÇ
‚îÇ   ‚îú‚îÄ destination address                                   ‚îÇ
‚îÇ   ‚îú‚îÄ destination port (2 –±–∞–π—Ç–∞)                            ‚îÇ
‚îÇ   ‚îú‚îÄ application data (–Ω–∞—á–∞–ª–æ –ø–µ—Ä–µ–¥–∞—á–∏)                    ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–†–∞–∑–º–µ—Ä: 100-500 –±–∞–π—Ç + —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ø–µ—Ä–≤–æ–º –ø–∞–∫–µ—Ç–µ!
```

#### Data Packets (–ø–æ—Å–ª–µ handshake)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Header (5 –±–∞–π—Ç)                                            ‚îÇ
‚îÇ   ‚îú‚îÄ 23 03 03 (TLS 1.3 Application Data)                  ‚îÇ
‚îÇ   ‚îî‚îÄ length (2 –±–∞–π—Ç–∞, big-endian)                          ‚îÇ
‚îÇ   (XOR –µ—Å–ª–∏ random —Ä–µ–∂–∏–º)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ AEAD Encrypted (unitedKey):                                ‚îÇ
‚îÇ   ‚îú‚îÄ payload data (–¥–æ 8192 –±–∞–π—Ç)                           ‚îÇ
‚îÇ   ‚îî‚îÄ AEAD tag (16 –±–∞–π—Ç)                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–†–∞–∑–º–µ—Ä: 5 + payload + 16 –±–∞–π—Ç
Maximum payload: 8192 –±–∞–π—Ç (–º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 16384)
```

**–ü–æ—á–µ–º—É header –∫–∞–∫ TLS 1.3?**
```
1. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XTLS - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–±–∏–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
2. –õ–µ–≥—á–µ —Å–º–µ—à–∏–≤–∞–µ—Ç—Å—è —Å –Ω–∞—Å—Ç–æ—è—â–∏–º TLS —Ç—Ä–∞—Ñ–∏–∫–æ–º
3. –ú–µ–Ω—å—à–µ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–π –ø—Ä–∏ DPI
4. –ü—Ä–∏ XTLS –ø—Ä–æ–±–∏–≤–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–∏–º TLS
```

### Crypto Operations

#### Key Derivation

**1. nfsKey (Non-Forward-Secret Key):**
```go
// –°–µ—Ä–≤–µ—Ä
serverPrivKey := loadFromConfig() // X25519 private 32 bytes
clientPubKey := receiveFromClient() // X25519 public 32 bytes
x25519Shared := ecdh.X25519(serverPrivKey, clientPubKey)

mlkemPrivKey := loadMLKEMFromConfig() // ML-KEM-768 seed 64 bytes
mlkemCT := receiveFromClient() // ML-KEM-768 ciphertext 1088 bytes
mlkemShared := mlkem768.Decapsulate(mlkemPrivKey, mlkemCT)

nfsKey := BLAKE3(x25519Shared || mlkemShared || "vless-encryption-nfs")
```

**2. pfsKey (Perfect-Forward-Secret Key):**
```go
// 1-RTT: Ephemeral key exchange
clientEphemeralPub := receiveFromClient() // 32 bytes
serverEphemeralPriv := generateRandom() // 32 bytes
serverEphemeralPub := ecdh.X25519(serverEphemeralPriv, G)
x25519EphShared := ecdh.X25519(serverEphemeralPriv, clientEphemeralPub)

mlkemEphCT := receiveFromClient() // 1088 bytes
mlkemEphShared := mlkem768.Decapsulate(mlkemEphPriv, mlkemEphCT)

pfsKey := BLAKE3(x25519EphShared || mlkemEphShared || "vless-encryption-pfs")

// –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
defer clearMemory(serverEphemeralPriv)
defer clearMemory(mlkemEphPriv)
```

**3. unitedKey (Combined Key):**
```go
unitedKey := BLAKE3(pfsKey || nfsKey || "vless-encryption-united")

// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è AEAD
aeadKey := HKDF(unitedKey, "aes-256-gcm")
// –∏–ª–∏
aeadKey := HKDF(unitedKey, "chacha20-poly1305")
```

#### AEAD Encryption

**AES-256-GCM (–µ—Å–ª–∏ hardware support):**
```go
func encryptPacket(unitedKey []byte, plaintext []byte, packetNumber uint64) []byte {
    // Derive packet key
    packetKey := HKDF(unitedKey, packetNumber)
    
    // Nonce: packet number (8 bytes) + zeros (4 bytes)
    nonce := make([]byte, 12)
    binary.BigEndian.PutUint64(nonce[0:8], packetNumber)
    
    // AEAD encrypt
    cipher, _ := aes.NewCipher(packetKey)
    aead, _ := cipher_suites.NewGCM(cipher)
    
    // AD = 5-byte header (23 03 03 length)
    header := []byte{0x23, 0x03, 0x03, 
                     byte(len(plaintext) >> 8), 
                     byte(len(plaintext))}
    
    ciphertext := aead.Seal(nil, nonce, plaintext, header)
    return append(header, ciphertext...)
}
```

**ChaCha20-Poly1305 (–µ—Å–ª–∏ –Ω–µ—Ç AES-NI):**
```go
func encryptPacketChaCha(unitedKey []byte, plaintext []byte, packetNumber uint64) []byte {
    packetKey := HKDF(unitedKey, packetNumber)
    nonce := make([]byte, 12)
    binary.BigEndian.PutUint64(nonce[4:12], packetNumber)
    
    aead, _ := chacha20poly1305.New(packetKey)
    header := makeHeader(len(plaintext))
    ciphertext := aead.Seal(nil, nonce, plaintext, header)
    return append(header, ciphertext...)
}
```

#### Random Mode XOR

**Header XOR (—Ç–æ–ª—å–∫–æ random —Ä–µ–∂–∏–º):**
```go
func xorHeader(header []byte, unitedKey []byte, packetNumber uint64) []byte {
    // AES-256-CTR –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ keystream
    block, _ := aes.NewCipher(unitedKey)
    
    // IV = packet number
    iv := make([]byte, 16)
    binary.BigEndian.PutUint64(iv[8:16], packetNumber)
    
    stream := cipher.NewCTR(block, iv)
    xorStream := make([]byte, 5)
    stream.XORKeyStream(xorStream, header)
    
    return xorStream
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
header := []byte{0x23, 0x03, 0x03, lengthHigh, lengthLow}
xoredHeader := xorHeader(header, unitedKey, packetNumber)
// –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–µ 5 –±–∞–π—Ç
```

**Public Key XOR (xorpub/random —Ä–µ–∂–∏–º—ã):**
```go
func xorPublicKey(pubKey []byte, nfsKey []byte) []byte {
    // Derive XOR mask from nfsKey
    mask := BLAKE3(nfsKey || "pubkey-xor-mask")
    mask = mask[:len(pubKey)] // –û–±—Ä–µ–∑–∞–µ–º –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã
    
    xored := make([]byte, len(pubKey))
    for i := range pubKey {
        xored[i] = pubKey[i] ^ mask[i]
    }
    return xored
}

// X25519: 32 –±–∞–π—Ç–∞
x25519XORed := xorPublicKey(x25519Pub, nfsKey)

// ML-KEM-768: 1184 –±–∞–π—Ç–∞
mlkemXORed := xorPublicKey(mlkemCT, nfsKey)
```

### Ticket Management

#### Ticket Generation (Server)

```go
type Ticket struct {
    PfsKey    [32]byte  // Perfect-forward-secret key
    IssuedAt  int64     // Unix timestamp
    ExpiresAt int64     // Unix timestamp
    ClientID  [16]byte  // UUID –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
}

func generateTicket(pfsKey []byte, clientUUID []byte, validity int) []byte {
    ticket := Ticket{
        PfsKey:    [32]byte(pfsKey),
        IssuedAt:  time.Now().Unix(),
        ExpiresAt: time.Now().Unix() + int64(validity),
        ClientID:  [16]byte(clientUUID),
    }
    
    // –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
    ticketBytes := serializeTicket(ticket)
    
    // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ticket —Å server secret (–Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É)
    serverSecret := loadServerSecret()
    cipher, _ := aes.NewCipher(serverSecret)
    aead, _ := cipher_suites.NewGCM(cipher)
    
    nonce := make([]byte, 12)
    rand.Read(nonce)
    
    encryptedTicket := aead.Seal(nonce, nonce, ticketBytes, nil)
    return encryptedTicket
}
```

#### Ticket Validation (Server, 0-RTT)

```go
func validateTicket(encryptedTicket []byte) (*Ticket, error) {
    // 1. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
    serverSecret := loadServerSecret()
    cipher, _ := aes.NewCipher(serverSecret)
    aead, _ := cipher_suites.NewGCM(cipher)
    
    nonce := encryptedTicket[:12]
    ciphertext := encryptedTicket[12:]
    
    ticketBytes, err := aead.Open(nil, nonce, ciphertext, nil)
    if err != nil {
        return nil, errors.New("invalid ticket")
    }
    
    ticket := deserializeTicket(ticketBytes)
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
    if time.Now().Unix() > ticket.ExpiresAt {
        return nil, errors.New("ticket expired")
    }
    
    // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ map (anti-replay)
    ticketHash := BLAKE3(encryptedTicket)
    if _, exists := server.ticketMap[ticketHash]; !exists {
        return nil, errors.New("unknown ticket")
    }
    
    return &ticket, nil
}
```

#### Ticket Cleanup

```go
func cleanupExpiredTickets(server *Server) {
    ticker := time.NewTicker(1 * time.Minute)
    defer ticker.Stop()
    
    for {
        <-ticker.C
        now := time.Now().Unix()
        
        server.ticketMapMutex.Lock()
        for ticketHash, ticketInfo := range server.ticketMap {
            if now > ticketInfo.ExpiresAt {
                delete(server.ticketMap, ticketHash)
            }
        }
        server.ticketMapMutex.Unlock()
        
        server.nfsKeyMapMutex.Lock()
        for nfsKeyHash, timestamp := range server.nfsKeyMap {
            if now - timestamp > 600 { // 10 –º–∏–Ω—É—Ç
                delete(server.nfsKeyMap, nfsKeyHash)
            }
        }
        server.nfsKeyMapMutex.Unlock()
    }
}
```

### XTLS Integration

#### Connection Unwrapping

```go
func UnwrapRawConn(conn net.Conn) (net.Conn, stats.Counter, stats.Counter) {
    var readCounter, writerCounter stats.Counter
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ encryption layer
    isEncryption := false
    if commonConn, ok := conn.(*encryption.CommonConn); ok {
        conn = commonConn.Conn
        isEncryption = true
    }
    
    // 2. XorConn –Ω–µ –ø—Ä–æ–±–∏–≤–∞–µ—Ç—Å—è (random —Ä–µ–∂–∏–º)
    if xorConn, ok := conn.(*encryption.XorConn); ok {
        return xorConn, nil, nil // Return as-is
    }
    
    // 3. Unwrap stats
    if statConn, ok := conn.(*stat.CounterConnection); ok {
        conn = statConn.Connection
        readCounter = statConn.ReadCounter
        writerCounter = statConn.WriteCounter
    }
    
    // 4. Unwrap TLS/REALITY (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ encryption layer)
    if !isEncryption {
        if xc, ok := conn.(*tls.Conn); ok {
            conn = xc.NetConn()
        } else if utlsConn, ok := conn.(*tls.UConn); ok {
            conn = utlsConn.NetConn()
        } else if realityConn, ok := conn.(*reality.Conn); ok {
            conn = realityConn.NetConn()
        }
    }
    
    // 5. Unwrap proxyproto
    if pc, ok := conn.(*proxyproto.Conn); ok {
        conn = pc.Raw()
    }
    
    // 6. Final check for RAW transport
    _, isTCP := conn.(*net.TCPConn)
    _, isUnix := conn.(*internet.UnixConnWrapper)
    
    if isTCP || isUnix {
        // –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ReadV/Splice
        return conn, readCounter, writerCounter
    }
    
    return conn, readCounter, writerCounter
}
```

#### Vision Flow Detection

```go
func detectTLSTraffic(buffer []byte) bool {
    // TLS 1.3 Client Hello: 0x16 0x03 0x03
    if len(buffer) < 5 {
        return false
    }
    
    if buffer[0] == 0x16 && // Handshake
       buffer[1] == 0x03 && // TLS 1.x
       buffer[2] == 0x03 {  // TLS 1.3
        return true
    }
    
    // TLS 1.3 Application Data: 0x17 0x03 0x03
    if buffer[0] == 0x17 &&
       buffer[1] == 0x03 &&
       buffer[2] == 0x03 {
        return true
    }
    
    return false
}

func handleXTLSVision(conn net.Conn, trafficState *TrafficState) {
    buffer := make([]byte, 8192)
    n, _ := conn.Read(buffer)
    
    if detectTLSTraffic(buffer[:n]) {
        // –ü–æ—Å–ª–µ TLS handshake –º–æ–∂–µ–º –ø—Ä–æ–±–∏—Ç—å
        trafficState.IsTLS = true
        trafficState.EnableSplice = true
    }
}
```

---

## Best Practices

### –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞

**Decision Tree:**
```
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –æ–±—Ö–æ–¥–∞ GFW?
‚îú‚îÄ –î–∞ ‚Üí ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ VLESS Encryption
‚îÇ         –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ REALITY –∏–ª–∏ XHTTP
‚îÇ
‚îî‚îÄ –ù–µ—Ç ‚Üí –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å?
          ‚îú‚îÄ –î–∞ ‚Üí Native + XTLS Vision + TCP
          ‚îÇ        (ReadV/Splice, –ª—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
          ‚îÇ
          ‚îî‚îÄ –ù–µ—Ç ‚Üí –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π DPI?
                    ‚îú‚îÄ –î–∞ ‚Üí Random + XTLS + aggressive padding
                    ‚îÇ        (–ü–æ–ª–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞, XOR headers)
                    ‚îÇ
                    ‚îî‚îÄ –ù–µ—Ç ‚Üí XorPub + XTLS
                              (–ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏/–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
```

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. CDN Proxy (–∑–∞—â–∏—Ç–∞ UUID –æ—Ç CDN –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)

**–ü—Ä–æ–±–ª–µ–º–∞**: CDN –≤–∏–¥–∏—Ç VLESS UUID –∏ SNI –≤ plaintext

**–†–µ—à–µ–Ω–∏–µ**:
```json
// –ö–ª–∏–µ–Ω—Ç ‚Üí CDN ‚Üí –í–∞—à —Å–µ—Ä–≤–µ—Ä
{
  "outbounds": [{
    "protocol": "vless",
    "settings": {
      "vnext": [{
        "address": "cdn.cloudflare.com",
        "port": 443,
        "users": [{
          "id": "UUID",
          "flow": "xtls-rprx-vision",
          "encryption": "mlkem768x25519plus.native.0rtt..keys..."
        }]
      }]
    },
    "streamSettings": {
      "network": "xhttp",
      "security": "none"  // Encryption already in VLESS
    }
  }]
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ CDN –Ω–µ –≤–∏–¥–∏—Ç UUID
- ‚úÖ CDN –Ω–µ –≤–∏–¥–∏—Ç SNI
- ‚úÖ CDN –Ω–µ –º–æ–∂–µ—Ç MITM (–Ω–µ –∏–º–µ–µ—Ç server private key)
- ‚úÖ 0-RTT –¥–ª—è –Ω–∏–∑–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ —á–µ—Ä–µ–∑ CDN

#### 2. Relay Chain (—Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –±–µ–∑ TLS)

**–ü—Ä–æ–±–ª–µ–º–∞**: –°—Ä–µ–¥–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—Ä–µ—â–∞–µ—Ç HTTPS/TLS

**–†–µ—à–µ–Ω–∏–µ**:
```json
// –ö–ª–∏–µ–Ω—Ç ‚Üí Relay (no TLS) ‚Üí Final (no TLS) ‚Üí Internet
{
  "encryption": "mlkem768x25519plus.xorpub.0rtt..relayPass.relayClient.finalPass.finalClient"
}
```

**Relay —Å–µ—Ä–≤–µ—Ä**:
```json
{
  "inbounds": [{
    "port": 8080, // HTTP –ø–æ—Ä—Ç
    "protocol": "vless",
    "settings": {
      "decryption": "mlkem768x25519plus.xorpub.600s..relayPriv.relaySeed"
    }
  }],
  "outbounds": [{
    "protocol": "vless",
    "settings": {
      "vnext": [{
        "address": "final-server",
        "port": 8080,
        "users": [{
          "encryption": "mlkem768x25519plus.xorpub.0rtt..finalPass.finalClient"
        }]
      }]
    }
  }]
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ù–µ—Ç TLS overhead
- ‚úÖ Relay –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–ª–æ–π
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

#### 3. Non-TLS Country (–ò—Ä–∞–Ω —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ TLS)

**–ü—Ä–æ–±–ª–µ–º–∞**: TLS throttled –∏–ª–∏ blocked

**–†–µ—à–µ–Ω–∏–µ**:
```json
{
  "encryption": "mlkem768x25519plus.random.0rtt.100-500-2000.90-100-500..keys...",
  "streamSettings": {
    "network": "tcp",
    "security": "none"
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–π –≤–∏–¥ (–Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ TLS)
- ‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π padding —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- ‚úÖ –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

#### 4. Machine-to-Machine (M2M) Communication

**–ü—Ä–æ–±–ª–µ–º–∞**: API servers communicating, need encryption but not censorship resistance

**–†–µ—à–µ–Ω–∏–µ**:
```json
// Service A ‚Üí Service B (datacenter)
{
  "encryption": "mlkem768x25519plus.native.1rtt..keys...",  // Always 1-RTT
  "streamSettings": {
    "network": "tcp",
    "sockopt": {
      "tcpFastOpen": true
    }
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ Low latency (no ticket management)
- ‚úÖ Perfect Forward Secrecy –¥–ª—è compliance
- ‚úÖ Quantum resistance –¥–ª—è long-term security
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ—Ç padding)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í–∫–ª—é—á–∏—Ç—å debug logs:**
```json
{
  "log": {
    "loglevel": "debug",
    "access": "/var/log/xray/access.log",
    "error": "/var/log/xray/error.log"
  }
}
```

**–í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
```bash
# Replay attacks
grep "replay detected" /var/log/xray/error.log

# Invalid tickets (–≤–æ–∑–º–æ–∂–Ω–æ –∞—Ç–∞–∫–∞ –∏–ª–∏ clock skew)
grep "unknown ticket" /var/log/xray/error.log

# Handshake failures
grep "handshake failed" /var/log/xray/error.log

# XTLS splice events (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
grep "splice" /var/log/xray/access.log
```

#### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**Xray stats API:**
```json
{
  "stats": {},
  "api": {
    "tag": "api",
    "services": ["StatsService"]
  },
  "policy": {
    "system": {
      "statsInboundUplink": true,
      "statsInboundDownlink": true
    }
  }
}
```

**–ó–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
```bash
# Total traffic
xray api stats --server=127.0.0.1:8080

# Per-user traffic
xray api stats --server=127.0.0.1:8080 --name="user>>>user1@example.com>>>traffic>>>uplink"
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**tcpdump –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞:**
```bash
# Capture VLESS Encryption traffic
tcpdump -i eth0 -w vless_capture.pcap 'tcp port 8443'

# –ê–Ω–∞–ª–∏–∑ –≤ Wireshark:
# - Native —Ä–µ–∂–∏–º: –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ TLS 1.3
# - Random —Ä–µ–∂–∏–º: –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã
# - Padding: —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–µ—Ä–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ XTLS splice:**
```bash
# –ù–∞ Linux —Å–µ—Ä–≤–µ—Ä–µ
ss -ti | grep xray

# –í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å splice:
# tcp   ESTAB  0  0  192.168.1.10:8443  client:54321
#      skmem:(r0,rb131072,t0,tb87040,f4096,w0,o0,bl0,d0) ts splice:1
```

### Troubleshooting Common Issues

#### 1. "unknown ticket" errors

**–ü—Ä–∏—á–∏–Ω—ã:**
- Ticket –∏—Å—Ç–µ–∫ (>10 –º–∏–Ω—É—Ç)
- –°–µ—Ä–≤–µ—Ä –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω (ticket map –æ—á–∏—â–µ–Ω)
- Clock skew –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å clock skew
date; ssh server date

# –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ >1 –º–∏–Ω—É—Ç–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
ntpdate pool.ntp.org

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 1-RTT
"encryption": "mlkem768x25519plus.native.1rtt..keys..."
```

#### 2. "replay detected" warnings

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°–µ—Ç–µ–≤—ã–µ —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏ (TCP)
- –ê—Ç–∞–∫–∞ replay
- Client library bug

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
mtr server.example.com

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏
netstat -s | grep retransmit

# –ï—Å–ª–∏ –∞—Ç–∞–∫–∞ - –∑–∞–±–∞–Ω–∏—Ç—å IP
iptables -A INPUT -s ATTACKER_IP -j DROP
```

#### 3. –ù–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ü—Ä–∏—á–∏–Ω—ã:**
- XTLS –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è (–Ω–µ—Ç TLS —Ç—Ä–∞—Ñ–∏–∫–∞)
- Random —Ä–µ–∂–∏–º (XOR overhead)
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è hardware AES

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hardware AES support
grep -o 'aes' /proc/cpuinfo

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å XTLS –∞–∫—Ç–∏–≤–∞—Ü–∏—é
grep "XTLS\|splice" /var/log/xray/access.log

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ native –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
"encryption": "mlkem768x25519plus.native.0rtt..keys..."

# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ flow –Ω–∞—Å—Ç—Ä–æ–µ–Ω
"flow": "xtls-rprx-vision"
```

#### 4. Handshake failures

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (mismatch)
- –í–µ—Ä—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞/—Å–µ—Ä–≤–µ—Ä–∞ incompatible
- Padding –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏
xray version  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å >= v25.9.5

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á–∏ (hash32 –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å)
./xray x25519 -i "PrivateKey"    # –°–µ—Ä–≤–µ—Ä
./xray x25519 -i "PrivateKey"    # –ö–ª–∏–µ–Ω—Ç (Password –∏–∑ –≤—ã–≤–æ–¥–∞)

# –£–ø—Ä–æ—Å—Ç–∏—Ç—å padding (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å default)
"encryption": "mlkem768x25519plus.native.0rtt..keys..."  # –ë–µ–∑ custom padding
```

#### 5. –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ CDN

**–ü—Ä–∏—á–∏–Ω—ã:**
- CDN –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç XHTTP protocol
- WebSocket fallback –Ω—É–∂–µ–Ω
- Timeout —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```json
{
  "streamSettings": {
    "network": "xhttp",
    "xhttpSettings": {
      "mode": "stream-up",
      "path": "/api",
      "host": "example.com"
    },
    "sockopt": {
      "dialerProxy": "cdn-friendly"
    }
  }
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

VLESS Encryption –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏-—Ç—Ä–∞—Ñ–∏–∫–∞ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞:
- **Post-Quantum –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é** (ML-KEM-768)
- **Perfect Forward Secrecy** (—ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏)
- **–ó–∞—â–∏—Ç—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞** (–ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –≤–º–µ—Å—Ç–æ PSK)
- **–í—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (XTLS ReadV/Splice, –Ω–µ—Ç extra AEAD)
- **–ì–∏–±–∫–æ—Å—Ç—å** (—Ç—Ä–∏ —Ä–µ–∂–∏–º–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π padding)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VLESS Encryption:**
‚úÖ CDN –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∑–∞—â–∏—Ç–æ–π UUID
‚úÖ Relay —Ü–µ–ø–æ—á–∫–∏ –±–µ–∑ TLS
‚úÖ Non-TLS –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ò—Ä–∞–Ω)
‚úÖ –û–±—Ö–æ–¥ –∞—É–¥–∏—Ç–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
‚úÖ M2M –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å PFS —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏

**–ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
‚ùå –ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ GFW (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ REALITY)
‚ùå –ù—É–∂–µ–Ω TLS camouflage (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ REALITY)
‚ùå Active probing –∑–∞—â–∏—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ REALITY)

### –î–∞–ª—å–Ω–µ–π—à–µ–µ —á—Ç–µ–Ω–∏–µ

- **PR #5067**: https://github.com/XTLS/Xray-core/pull/5067
- **REALITY**: https://github.com/XTLS/Xray-core/pull/4915
- **XHTTP**: https://github.com/XTLS/Xray-core/discussions/4113
- **Vision**: https://github.com/XTLS/Xray-core/discussions/1295
- **ML-KEM NIST**: https://csrc.nist.gov/pubs/fips/203/final

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **GitHub**: https://github.com/XTLS/Xray-core
- **Telegram**: https://t.me/projectXtls
- **NFT**: https://opensea.io/collection/vless

---

